<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Preview - Extracted Emails</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
  body{background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;display:flex;align-items:center;justify-content:center;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;}
  .card{padding:22px;border-radius:12px;background:#fff;max-width:1100px;width:100%;box-shadow:0 20px 40px rgba(0,0,0,0.18);}
  h1{background:linear-gradient(90deg,#764ba2,#667eea);-webkit-background-clip:text;color:transparent;text-align:center;margin-bottom:12px;}
  .table-responsive{max-height:500px;overflow:auto;border-radius:8px;padding:10px;background:#fafafa;}
  .note{font-size:0.9rem;color:#666;}
  a.btn{border-radius:10px;padding:10px 16px;font-weight:600;}
</style>
</head>
<body>
<div class="card">
  <h1>Preview: Updated Excel</h1>
  <div class="mb-2 note">Column used for extraction: <strong>{{ used_desc_col }}</strong></div>

  <div class="table-responsive mb-3">
    {% for table in tables %}
      {{ table|safe }}
    {% endfor %}
  </div>

  <div class="d-flex gap-2">
    <a href="/download/{{ filename }}" class="btn btn-success">Download Updated Excel</a>
    <a href="/" class="btn btn-secondary">Process another file</a>
  </div>
</div>
</body>
</html>
