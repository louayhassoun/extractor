<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Excel Email Extractor</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
  body {
    background: linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    min-height:100vh;display:flex;align-items:center;justify-content:center;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
  }
  .card { border-radius:12px;padding:28px;max-width:720px;width:100%;box-shadow:0 20px 40px rgba(0,0,0,0.18);background:#fff; }
  h1 { background:linear-gradient(90deg,#764ba2,#667eea);-webkit-background-clip:text;color:transparent;font-weight:700;margin-bottom:10px;text-align:center; }
  .muted { color:#6b6b6b;font-size:0.95rem; }
  .note { font-size:0.9rem;color:#444; }
  input.form-control, select.form-select { border-radius:8px;padding:12px; }
  .btn-primary { background:linear-gradient(90deg,#764ba2,#667eea);border:none;padding:12px 18px;border-radius:10px;font-weight:600; }
  .btn-primary:active{transform:scale(.99); }
  .alert { border-radius:8px; }
</style>
</head>
<body>
<div class="card">
  <h1>Excel Email Extractor</h1>
  <p class="muted text-center mb-3">Upload your Excel file from ec.europa.eu. The tool will scan the description (or chosen) column and add an <strong>Emails</strong> column with any found emails (each on a new line).</p>

  {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endif %}

  <form method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label class="form-label">Choose Excel file (.xlsx / .xls)</label>
      <input class="form-control" type="file" name="excel_file" accept=".xlsx,.xls" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Description column name (optional)</label>
      <input class="form-control" name="description_column" placeholder="Default: Description (will try to auto-guess otherwise)">
      <div class="note mt-1">If unsure, leave empty â€” the tool will try to find a column named like "Description" or fallback to the first column.</div>
    </div>

    <button class="btn btn-primary w-100" type="submit">Process file &amp; Extract Emails</button>
  </form>

  <div class="text-center mt-3">
    <a href="/reset" class="text-decoration-none text-muted">Reset last output (delete generated file)</a>
  </div>
</div>
</body>
</html>
